.\" Copyright (c) 1995 James R. Van Zandt <jrv@vanzandt.mv.com>
.\" Sat Feb 18 09:11:07 EST 1995
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
.\" USA.
.\"
.\" Modified, Sun Feb 26 15:08:05 1995, faith@cs.unc.edu
.\" "
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\"
.\" Mise à jour 06/06/2001 - LDP-man-pages-1.36
.\" LDP 1.47
.\" MàJ 25/07/2003 LDP-1.56
.TH VCS 4 "25 juillet 2003" LDP "Manuel du programmeur Linux" 
.SH NOM
vcs, vcsa \- Mémoires des consoles virtuelles.
.SH DESCRIPTION
\fB/dev/vcs0\fP est un périphérique caractères de numéro majeur 7 et
de numéro mineur 0, avec les permissions 0644 et un propriétaire root.tty.

Il correspond à la mémoire d'affichage de la console virtuelle en
cours d'utilisation.
.LP
\fB/dev/vcs[1-63]\fP sont des périphériques caractères représentant
la mémoire d'affichage des consoles virtuelles. 
Ils ont un numéro majeur 7 et des numéros mineurs 1 à 63.
Ils ont généralement un mode d'accès 0644 et un propriétaire root.tty.

Les \fB/dev/vcsa[0-63]\fP sont équivalents mais incluent en plus les
attributs, et sont préfixés avec 4 octets indiquant les dimensions
de l'écran et la position du curseur :
\fIlines\fP, \fIcolumns\fP, \fIx\fP, \fIy\fP.
(\fIx\fP = \fIy\fP = 0 en haut à gauche de l'écran.)
.PP
Ceci remplace les
.IR ioctl s
"screendump" de \fBconsole\fP(4), ainsi
l'administrateur peut contrôler les accès en utilisant les
permissions du système de fichiers.
.PP
Les périphériques pour les 8 premières consoles virtuelles peuvent
être créés ainsi :

.nf
	for x in 0 1 2 3 4 5 6 7 8; do 
		mknod -m 644 /dev/vcs$x c 7 $x;
		mknod -m 644 /dev/vcsa$x c 7 $[$x+128];
	done
	chown root:tty /dev/vcs*
.fi

Aucune requête
.IR ioctl ()
n'est supportée.
.SH EXEMPLES
On peut faire un screendump de la console vt3 en basculant sur
vt1 et en tapant \fIcat /dev/vcs3 >foo\fP. 
Notez que la sortie ne contient pas de caractères de retour-chariot,
aussi quelques manipulations peuvent être nécessaires comme
\fIfold -w 81 /dev/vcs3 | lpr\fP ou (horrible !)
\fIsetterm -dump 3 -file /proc/self/fd/1\fP.

Ce programme affiche le caractère et l'attribut d'écran sous le curseur
de la seconde console virtuelle, puis y change la couleur de fond :

.nf
	#include <unistd.h>
	#include <stdio.h>
	#include <fcntl.h>

	int main ()
	{	int fd;
		struct {char lines, cols, x, y;} scrn;
		char ch, attrib;

		fd = open("/dev/vcsa2", O_RDWR);
		(void)read(fd, &scrn, 4);
		(void)lseek(fd, 4 + 2*(scrn.y*scrn.cols + scrn.x), 0);
		(void)read(fd, &ch, 1);
		(void)read(fd, &attrib, 1);
		printf("ch='%c' attrib=0x%02x\\n", ch, attrib);
		attrib ^= 0x10;
		(void)lseek(fd, -1, 1);
		(void)write(fd, &attrib, 1);
	}
.fi

.SH FICHIERS
/dev/vcs[0-63]
.br
/dev/vcsa[0-63]
.SH AUTEUR
Andries Brouwer <aeb@cwi.nl>
.SH HISTORIQUE
Introduits dans la version 1.1.92 du noyau Linux.
.SH "VOIR AUSSI"
.BR console (4),
.BR tty (4),
.BR ttys (4),
.BR selection (1)

.SH TRADUCTION
Christophe Blaess, 1996-2003.
