.Id $Id: at.1.in,v 1.8 1997/09/28 20:00:25 ig25 Exp $
.\" Traduction 16/04/1997 par Christophe Blaess (ccb@club-internet.fr)
.\"
.\" Màj 30/07/2003 at-3.1.8
.\" Màj 14/12/2005 at-3.1.9
.\"
.TH AT 1 "30 juillet 2003" at "Manuel de l'utilisateur Linux"
.SH NOM
at, batch, atq, atrm \- Mémoriser, examiner ou supprimer des jobs à exécuter ultérieurement.
.SH SYNOPSIS
.B at
.RB [ -V ]
.RB [ -q
.IR file ]
.RB [ -f
.IR fichier ]
.RB [ -mldbv ]
.B HEURE
.br
.B "at -c"
.I commande
.RI [ commande... ]
.br
.B atq
.RB [ -V ]
.RB [ -q
.IR file ]
.br
.B atrm
.RB [ -V ]
.I commande
.RI [ commande... ]
.br
.B batch
.SH DESCRIPTION
.B at
et
.B batch
lisent, depuis l'entrée standard, ou depuis un fichier, des commandes
qu'ils exécuteront ultérieurement, en utilisant
.BR /bin/sh .
.TP 8
.BR at
lance les commandes indiquées à une heure précise.
.TP 8
.BR atq
affiche la liste des commandes en attente d'exécution pour l'utilisateur
appelant, sauf s'il s'agit du super\-utilisateur auquel cas toutes les
commandes en attente sont listées. Le format de sortie est (une ligne par
job)\ : numéro de job, date, heure, file et nom d'utilisateur.
.TP 8
.BR atrm
efface les travaux en attente, identifiés par leurs numéros de job.
.TP 8
.B batch
exécute les commandes indiquées lorsque la charge système le permet,
c'est à dire lorsque la charge du processeur descend sous 0.8, ou
en dessous d'une valeur mentionnée explicitement durant l'invocation de
.BR atd .
.PP
.B At
permet d'indiquer l'heure de lancement de manière assez complexe, en
extension de la norme POSIX.2. Il accepte des spécifications de la forme
.B HH:MM
pour exécuter un travail à une heure donnée de la journée en cours (ou
du lendemain si l'heure mentionnée est déjà dépassée).
On peut aussi lui fournir l'un des arguments suivants\ :
.B midnight
(minuit),
.B noon
(midi),
ou
.B teatime
(l'heure du thé, soit 16 heures).
Il est également possible de fournir un suffixe du type
.B AM
(matin), ou
.B PM
(après-midi) avec une heure sur un cadran de 12 heures.
On peut indiquer le jour de lancement, en précisant une date du type
.B nom-du-mois
(en anglais)
.B jour
et éventuellement
.BR année ,
ou encore une date du type
.B MMJJAA
ou
.B MM/JJ/AA
ou
.BR JJ.MM.AA .
La date
.I doit
suivre l'heure.
On peut indiquer une heure de la forme
.B now
(maintenant)
.B \+
.I nombre
.RI "d'" unités ,
où les unités peuvent être
.BR minutes ,
.B hours
(heures),
.B days
(jours), ou
.B weeks
(semaines) et on peut également demander à
.B at
de déclencher le travail le jour même en ajoutant le suffixe
.B today
ou le lendemain en ajoutant
.BR tomorrow .
.PP
Par exemple, pour lancer une commande à 16 heures, 3 jours plus tard,
on peut indiquer
.BR "at 4pm + 3 days" ,
pour lancer le travail à 10 heures du matin le 31 juillet, il faut invoquer
.B at 10am Jul 31
et pour lancer une commande à 1 heure du matin le lendemain, effectuez
.BR "at 1am tomorrow" .
.PP
.IR /usr/share/doc/at-3.1.9/timespec
contient les définitions exactes des spécifications horaires.
.PP
Aussi bien
.B at
que
.B batch
lisent les commandes à mémoriser depuis l'entrée standard, ou dans le
fichier indiqué par l'option
.BR -f .
Le répertoire de travail, l'environnement (sauf pour les variables
.BR TERM ,
.BR DISPLAY
et
.BR _ )
ainsi que le
.I umask
sont mémorisés au moment de l'invocation. Une commande
.BR "at " -
ou
.BR "batch " -
invoquée depuis un shell obtenu par
.BR su (1)
mémorisera l'U-ID en cours.
L'appelant recevra par courrier (mail) les messages écrits sur les flux de
sortie standard et d'erreur standard, s'il y en a.
Le courrier sera envoyé en utilisant la commande
.BR /usr/sbin/sendmail .
Si
.B at
est invoquée depuis un shell obtenu par
.BR su (1),
le courrier sera envoyé à l'utilisateur correspondant au login.
.PP
Le super\-utilisateur peut toujours employer ces commandes. Pour les
autres utilisateurs, les permissions sont déterminées
par les fichiers
.I /etc/at.allow
et
.IR /etc/at.deny .
.PP
Si le fichier
.I /etc/at.allow
existe, seuls les utilisateurs dont les noms sont mentionnés dans
ce fichier peuvent utiliser
.BR at .
.PP
Si
.I /etc/at.allow
n'existe pas, \fBat\fP vérifie si
.I /etc/at.deny
existe, et tous les utilisateurs non-mentionnés dans ce fichier ont
le droit d'invoquer
.BR at .
.PP
Si aucun de ces deux fichiers n'existe, seul le super\-utilisateur a
le droit d'appeler
.BR at .
.PP
Un fichier
.I /etc/at.deny
vide signifie que tous les utilisateurs ont le droit d'appeler ces
commandes, c'est la configuration par défaut.
.SH OPTIONS
.TP 8
.B -V
Afficher un numéro de version sur la sortie d'erreur standard.
.TP 8
.BI \-q " file"
Utiliser la \fIfile\fP d'attente mentionnée.
Une file est désignée par une lettre unique, dans l'intervalle
.B a
jusqu'à
.BR z ,
et
.B A
jusqu'à
.BR Z .
La file
.B a
est la file d'attente par défaut pour
.B at
tandis que la file
.B b
est celle par défaut pour
.BR batch .
Plus les files ont une lettre importante, plus les travaux seront exécutés
avec une valeur de gentillesse (voir \fBnice\fP(1)) élevée. La file spéciale
«\ =\ » est réservée pour les jobs en cours d'exécution.
.PP
Si une tâche est soumise à une file désignée par une lettre majuscule, celle-ci
est traitée par
.B batch
à l'\fIheure\fP prévue. Une fois l'horaire atteint, les règles de
traitement par lots s'appliquent selon de la charge moyenne. Si l'on invoque
.BR atq
avec un nom de file spécifique, il ne montrera que les travaux en attente
dans cette file.
.TP 8
.B \-m
Envoyer un courrier à l'utilisateur lorsque le travail est terminé, même
s'il n'a rien écrit sur ses flux de sortie.
.TP 8
.BI \-f " fichier"
Lire la commande à exécuter dans le
.BI fichier
et non pas sur l'entrée standard.
.TP 8
.B \-l
Est un alias pour
.BR atq .
.TP
.B \-d
Est un alias pour
.BR atrm .
.TP
.B \-v
Afficher les heures de lancement programmées avant de lire le job.
.P
Les heures seront affichées avec le format «\ Thu Feb 20 14:50:00 1997\ ».
.TP
.B
\-c
Imprimer sur la sortie standard les travaux mentionnés sur la ligne de commande.
.SH FICHIERS
.I /var/spool/at
.br
.I /var/spool/at/spool
.br
.I /proc/loadavg
.br
.I /var/run/utmp
.br
.I /etc/at.allow
.br
.I /etc/at.deny
.SH "VOIR AUSSI"
.BR cron (1),
.BR nice (1),
.BR sh (1),
.BR umask (2),
.BR atd (8).
.SH BOGUES
Sous Linux,
.B batch
est tributaire d'un système de fichiers de type
.I proc
monté sur le répertoire
.IR /proc .
.PP
Si le fichier
.I /var/run/utmp
n'est pas disponible, ou est endommagé, ou si l'utilisateur n'est pas
connecté lorsque
.B at
est invoquée, le courrier est envoyé à l'U\-ID correspondant à la variable
d'environnement
.BR LOGNAME .
Si celle-ci est indéfinie ou vide, l'U\-ID courant est utilisé par défaut.
.PP
.B At
et
.BR batch ,
tels qu'ils sont implémentés actuellement, ne sont pas fiables lorsqu'il
y a une situation de manque de ressources systèmes. Si c'est régulièrement
le cas sur votre site, vous devriez vous orienter vers un autre système
de lancements différés, comme
.BR nqs .
.SH AUTEUR
At a été écrit principalement par Thomas Koenig, ig25@rz.uni-karlsruhe.de.

.SH TRADUCTION
.PP
Ce document est une traduction réalisée par Christophe Blaess
le 16 avril 1997, révisée le 30 juillet 2003. La dernière révision
a été effectuée par Alain Portal <aportal AT univ-montp2 DOT fr>
le 14 décembre 2005.
.PP
L'équipe de traduction a fait le maximum pour réaliser une adaptation
française de qualité. La version anglaise la plus à jour de ce document est
toujours consultable via la commande\ : «\ \fBLANG=en\ man\ 1\ at\fR\ ».
N'hésitez pas à signaler à l'auteur ou au traducteur, selon le cas, toute
erreur dans cette page de manuel.
