.\" (c) 1993 by Thomas Koenig (ig25@rz.uni-karlsruhe.de)
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\" License.
.\" Modified Sat Jul 24 17:51:15 1993 by Rik Faith (faith@cs.unc.edu)
.\"
.\" Traduction 10/11/1996 par Christophe Blaess (ccb@club-internet.fr)
.\" Mise à jour 14/12/1998 - LDP-man-pages-1.21
.\" Mise à jour 06/06/2001 - LDP-man-pages-1.36
.\" Mise à jour 28/01/2002 - LDP-man-pages-1.47
.\" MàJ 21/07/2003 LDP-1.56
.TH SYSTEM 3 "21 juillet 2003" LDP "Manuel du programmeur Linux"
.SH NOM
system \- Exécuter une commande Shell.
.SH SYNOPSIS
.nf
.B #include <stdlib.h>
.sp
.BI "int system (const char * " "string" ");"
.fi
.SH DESCRIPTION
La fonction
.B system()
exécute la commande indiquée dans
.I string
en appelant
.BR "/bin/sh -c"
.IR string ,
et revient après l'exécution complete de la commande. 
Durant cette exécution, le signal
.B SIGCHLD
est bloqué, et les signaux
.B SIGINT
et
.B SIGQUIT
sont ignorés.
.SH "VALEUR RENVOYÉE"
La valeur renvoyée est \-1 en cas d'erreur (par exemple echec de fork())
ou le code de retour de la commande sinon. Ce dernier code est dans le format
indiqué dans
.BR wait (2).
Ansi le retour de la commande sera
.IR WEXITSTATUS(status) .
Dans le cas où
.B "/bin/sh"
ne peut pas être exécuté, le code de retour sera identique à celui d'une
commande effectuant un
.IR exit(127) .
.PP
Si la valeur de
.I string
est
.BR NULL ,
.B system()
renvoie une valeur non nulle si le shell est accessible, et zéro sinon.
.PP
.B system()
n'affecte pas le statut d'attente des autres processus fils.
.SH "CONFORMITÉ"
ANSI C, POSIX.2, BSD 4.3
.SH NOTES
Comme mentionné plus haut,
.BR system ()
ignore SIGINT et SIGQUIT. Ceci peut rendre ininterruptible un programme
qui l'appelle en boucle, à moins qu'il ne vérifie le code de retour
du fils, par exemple
.br
.nf
    while(qqchose) {
        int ret = system("foo");
 
        if (WIFSIGNALED(ret) &&
            (WTERMSIG(ret) == SIGINT || WTERMSIG(ret) == SIGQUIT))
                break;
    }
.fi
.PP
N'utilisez jamais
.B system()
dans un programme avec les privilèges Set-UID ou Set-GID. Des variables
d'environnement avec des valeurs étranges peuvent être utilisées
pour corrompre l'intégrité du système. Utilisez les fonctions de la famille
.BR exec (3)
à la place, mais pas
.BR execlp (3)
ni
.BR execvp (3).
.PP
.B system()
ne fonctionnera pas correctement avec les programmes ayant des privilèges
fournis par les bits Set-UID ou Set-GID sur les systèmes où
.B /bin/sh
est
.B bash
version 2, car celui-ci rejette les privilèges au démarrage. (Debian utilise
une version modifiée de bash où ce comportement est abandonné si on l'invoque
sous le nom \fBsh\fP).
.PP
La vérification de disponibilité du shell
.B /bin/sh
n'est pas réellement faite. Il est toujours supposé disponible. Le standard
ISO C réclame cette vérification, mais POSIX.2 précise que le retour doit
toujours être non-nul car un système sans shell n'est pas conforme. Ceci
justifie le choix d'implémentation.
.PP
Il est possible qu'une commande shell renvoie 127, ainsi le code de retour
n'est pas une indication sûre de l'échec de
.BR execve() .
Verifiez
.I errno
pour en être sûrs.
.SH "VOIR AUSSI"
.BR sh (1),
.BR signal (2),
.BR wait (2),
.BR exec (3)
.SH TRADUCTION
Christophe Blaess, 1996-2003.
