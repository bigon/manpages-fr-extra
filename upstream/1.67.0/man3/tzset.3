.\" Copyright 1993 David Metcalfe (david@prism.demon.co.uk)
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" References consulted:
.\"     Linux libc source code
.\"     Lewine's _POSIX Programmer's Guide_ (O'Reilly & Associates, 1991)
.\"     386BSD man pages
.\" Modified Sun Jul 25 11:01:58 1993 by Rik Faith (faith@cs.unc.edu)
.\"
.\" Traduction 11/12/1996 par Christophe Blaess (ccb@club-internet.fr)
.\" Mise à jour 30/08/2000 - LDP 1.31
.\" Mise à jour 25/10/2002 - LDP 1.53
.\" MàJ 21/07/2003 LDP-1.56
.TH TZSET 3 "21 juillet 2003" LDP "Manuel du programmeur Linux"
.SH NOM
tzset, tzname, timezone, daylight \- Initialisation des données pour les conversions de temps.
.SH SYNOPSIS
.nf
.B #include <time.h>
.sp
.B void tzset (void);
.sp
.BI "extern char *" tzname [2]
.BI "extern long " timezone ;
.BI "extern int " daylight ;
.fi
.SH DESCRIPTION
La fonction \fBtzset()\fP initialise la variable \fItzname\fP en utilisant
la variable d'environnement TZ. Cette fonction est appelée automatiquement
par les autres fonctions de conversion dépendant du fuseau horaire.
Dans un environnement type Système V, elle remplira également les variables \fItimezone\fP
(secondes à l'ouest de Greenwich) et \fIdaylight\fP (0 si le fuseau n'a pas de changement
d'heure saisonnier, une valeur non nulle s'il y a des périodes durant l'année où
le changement horaire s'applique).
.PP
Si la variable TZ n'apparaît pas dans l'environnement, \fItzname\fP
est initialisée avec la meilleure approximation possible de l'heure
locale, comme indiqué dans le fichier
.IR localtime ,
au format
.BR tzfile (5),
se trouvant dans le répertoire système des fuseaux horaires (voir plus bas).
(on utilise souvent
.I /etc/localtime
ici, en tant que lien symbolique vers le répertoire système des fuseaux horaires).
.PP
Si la variable TZ est présente dans l'environnement, mais que sa valeur
est `NULL', ou si sa valeur ne peut pas être interprétée en utilisant le format
indiqué plus bas, l'heure TU (temps universel) est utilisée.
.PP
La valeur de TZ peut prendre trois formats différents. Le premier correspond
à un endroit où il n'y a pas de décalage heure d'hiver/heure d'été :
.sp
.RS
.I std offset
.RE
.sp
la chaîne \fIstd\fP indique le nom du fuseau horaire, constitué d'au moins
trois caractères alphabétiques. La chaîne \fIoffset\fP suivant immédiatement
\fIstd\fP indique la valeur à ajouter à l'heure locale pour obtenir l'heure
TU. La valeur \fIoffset\fP est positive si l'emplacement est à l'Ouest du
méridien 0, et négative si elle est à l'Est.
L'heure doit être entre 0 et 24, les minutes et les secondes
entre 0 et 59.
.PP
Le deuxième format est utilisé lorsqu'il existe des heures d'hiver et d'été différentes :
.sp
.RS
.I std offset dst [offset],start[/time],end[/time]
.RE
.sp
Les champs \fIstd\fP et \fIoffset\fP initiaux indiquent le fuseau horaire
comme précisé ci-dessus.
Les chaines \fIdst\fP et \fIoffset\fP indiquent le fuseau et le décalage
de la zone correspondant à l'heure d'été. Si l'offset est omis, une valeur
par défaut est utilisée, correspondant à une heure de décalage vers l'avant.
.PP
Le champ \fIstart\fP indique la date de début de l'heure d'été,
et \fIend\fP indique la date de retour à l'heure d'hiver. Ces deux champs
utilisent l'un des formats suivants :
.TP
J\fIn\fP
Indique le jour Julien, avec \fIn\fP compris entre 1 et 365. Le 29
Février n'est jamais compté, même pendant les années bissextiles.
.TP 
.I n
Indique le jour Julien, avec \fIn\fP compris entre 1 et 366. Le 29
Février est compté pendant les années bissextiles.
.TP 
M\fIm\fP.\fIs\fP.\fIj\fP
Indique le jour \fIj\fP (0 <= \fIj\fP <= 6) de la semaine \fIs\fP 
(1 <= \fIs\fP <= 5) du mois \fIm\fP (1 <= \fIm\fP <= 12).  La semaine 1 est
la première semaine du mois dans laquelle le jour \fIj\fP apparaît
et la semaine 5  la dernière où le jour \fIj\fP apparaît. Le jour 0 est Dimanche.
.PP
Le champ \fItime\fP indique l'heure du changement, sous forme d'heure locale
courante. Par défaut, la valeur est 02:00:00.
.PP
Le troisième format est utilisé pour indiquer que les informations de fuseau
horaire doivent être lues depuis un fichier :
.sp
.RS
:[filespec]
.RE
.sp
Si le fichier \fIfilespec\fP n'est pas indiqué, les informations sont
lues dans le fichier
.I localtime
se trouvant dans le répertoire système des fuseaux horaires, habituellement
.IR /usr/share/zoneinfo .
Ce fichier est au format
.BR tzfile (5)
Si \fIfilespec\fP est indique, il doit correspondre à un autre fichier au format
.BR tzfile (5)
où on lira les informations.
Si \fIfilespec\fP ne commence pas par un `/', le chemin d'accès est
considéré à partir du répertoire système des fuseaux horaires.
.SH FICHIERS
Le répertoire système employé pour les fuseaux horaires dépend de la
version de la bibliothèque C. Les libc4 et libc5 utilisaient
.IR /usr/lib/zoneinfo ,
puis, à partir de la libc-5.4.6 le répertoire
.I /usr/share/zoneinfo
si le premier n'existait pas.
La bibliothèque GlibC 2 utilise le contenu de la variable
d'environnement TZDIR lorsqu'elle existe. Par défaut c'est normalement
.IR /usr/share/zoneinfo .
.LP
Les fichiers se trouvant dans le répertoire sont :
.nf
localtime      fichier d'information horaire locale
posixrules     règles pour les TZ au format POSIX
.fi
.LP
Souvent,
.I /etc/localtime
est un lien symbolique vers
.I localtime
ou vers le fichier correct dans le répertoire système des fuseaux horaires.
.SH "CONFORMITÉ"
SVID 3, POSIX, BSD 4.3
.SH NOTES
Remarquez que la variable \fIdaylight\fP n'indique pas si le changement d'heure
saisonnier s'applique au moment de l'appel. Elle indique simplement le numéro d'un
algorithme (voyez la variable \fItz_dsttime\fP dans
.BR gettimeofday (2)).
C'est obsolète depuis longtemps, mais obligatoire avec SUSv2.
.LP
BSD4.3 a une routine \fIchar *timezone(zone,dst)\fP qui renvoie le nom du
fuseau horaire correspondant à son premier argument (minutes à l'ouest de Greenwich).
Si le second argument est 0, le nom standard est fourni, sinon c'est le nom avec
changement horaire saisonnier.
.SH "VOIR AUSSI"
.BR date (1),
.BR gettimeofday (2),
.BR time (2),
.BR ctime (3),
.BR getenv (3),
.BR tzfile (5)
.SH TRADUCTION
Christophe Blaess, 1997-2003.
