.\" Hey Emacs! This file is -*- nroff -*- source.
.\"
.\" Copyright (C) 1996 Andries Brouwer (aeb@cwi.nl)
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Traduction 14/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\" Màj 08/04/1997
.\" Màj 18/07/2003 LDP-1.56
.\" Màj 19/05/2005 LDP-1.59
.\" Màj 27/06/2005 LDP-1.60
.\"
.TH MSYNC 2 "21 août 2003" "Linux 2.4" "Manuel du programmeur Linux"
.SH NOM
msync \- Synchroniser un fichier et une projection en mémoire.
.SH SYNOPSIS
.B #include <sys/mman.h>
.sp
.BI "int msync(const void *" start ", size_t " length ", int " flags );
.SH DESCRIPTION
.B msync
écrit sur le disque les modifications qui ont été effectuées sur
la copie d'un fichier qui est projeté en mémoire par
.BR mmap (2).
Si l'on n'utilise pas cette fonction, rien ne garantit que les
changements soient écrits avant la suppression de la projection par
.BR munmap (2).
Pour être plus précis, la portion du fichier correspondant à
la zone mémoire commençant en
.I start
et ayant une longueur de
.I length
est mise à jour.
L'argument
.I flags
comprend les bits MS_ASYNC, MS_SYNC et MS_INVALIDATE.
M_ASYNC et M_SYNC ne peuvent pas être utilisés conjointement.
L'appel système revient immédiatement.
MS_SYNC demande une mise à jour immédiate, et attend qu'elle
se termine avant de revenir.
MS_INVALIDATE demande la désactivation de toutes les autres
projections du même fichier, afin qu'elles soient toutes remises
à jour avec les nouvelles données écrites.
.SH "VALEUR RENVOYÉE"
.B msync
renvoie 0 s'il réussit, ou \-1 s'il échoue, auquel cas
.I errno
contient le code d'erreur.
.SH ERREURS
.TP
.BR EINVAL
.I start
n'est pas aligné sur une frontière de page, ou d'autres
bits que MS_ASYNC | MS_INVALIDATE | MS_SYNC sont à 1
dans
.IR flags.
.TP
.B ENOMEM
La zone mémoire indiquée (ou une partie de cette zone) n'est
pas une projection.
.SH "DISPONIBILITÉ"
Sur les systèmes conformes à la spécification POSIX sur lequel
.B msync
est disponible, les constantes symboliques
.B _POSIX_MAPPED_FILES
et
.B _POSIX_SYNCHRONIZED_IO
sont définies dans <unistd.h> comme étant des valeurs supérieures à 0.
(Voir aussi
.BR sysconf (3).)
.\" POSIX 1003.1-2001: It shall be defined to -1 or 0 or 200112L.
.\" -1: unavailable, 0: ask using sysconf().
.\" glibc defines them to 1.
.SH "CONFORMITÉ"
POSIX 1.b (anciennement POSIX.4).

Cet appel a été introduit dans Linux 1.3.21, et utilisait EFAULT au lieu de
ENOMEM. Dans Linux 2.4.19, ceci a été remplacé par la valeur POSIX ENOMEM.
.SH "VOIR AUSSI"
.BR mmap (2),
B.O. Gallmeister, POSIX.4, O'Reilly, pp. 128-129 and 389-391.

.SH TRADUCTION
Christophe Blaess, 1996-2003.
