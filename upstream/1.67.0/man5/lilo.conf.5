.\"
.\" LILO program code, documentation and auxiliary programs are
.\" Copyright 1992-1994 Werner Almesberger.
.\" All rights reserved.
.\" 
.\" Redistribution and use in source and binary forms of parts of or the
.\" whole original or derived work are permitted provided that the
.\" original work is properly attributed to the author. The name of the
.\" author may not be used to endorse or promote products derived from
.\" this software without specific prior written permission. This work
.\" is provided "as is" and without any express or implied warranties.
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\" Mise à jour 18/05/99 - LDP-man-pages 1.23
.\" Mise à jour 30/07/03 - Lilo-21.4.4
.TH LILO.CONF 5 "30 juillet 2003" Lilo "Manuel de l'administrateur Linux"
.SH NOM
lilo.conf \- Fichier de configuration pour Lilo.
.SH DESCRIPTION
.LP
Ce fichier, par défaut
.IR /etc/lilo.conf ,
est lu lors de l'installation du chargeur Lilo (voir lilo(8)).
.LP
Il doit avoir la forme suivante
.IP
.nf
boot = /dev/hda
delay = 40
compact
vga = normal
root = /dev/hda1
read-only
image = /zImage-2.5.99
        label = try
image = /zImage-2.2.0
        label = 2.2.0
image = /tamu/vmlinuz
	label = tamu
	root = /dev/hdb2
	vga = ask
other = /dev/hda3
	label = dos
	table = /dev/hda
.fi
.LP
Ce fichier de configuration indique que Lilo utilise le secteur de boot
principal (Master Boot Record) sur le disque /dev/hda. (Pour plus d'information
sur les différentes manières d'utiliser Lilo, et les interactions avec d'autres
systèmes d'exploitation, voir le fichier user.tex de la documentation Lilo.)
.LP
Au démarrage, le chargeur va attendre 4 secondes (40 dixièmes de seconde) pour
une éventuelle pression sur SHIFT.
Si on ne presse pas SHIFT, l'image du premier noyau (/zImage-1.5.99, qui a
probablement été installé 5 minutes plus tôt) sera chargée.
Si l'on presse SHIFT, Lilo demandera quelle image utiliser pour démarrer.
En pressant [TAB] ou ([?] sur les claviers US), la liste des choix possibles
sera affichée. Il est alors possible de démarrer sur ce noyau flambant neuf ou
sur un noyau plus ancien, ou sur un noyau situé sur un autre système de
fichiers principal (juste au cas où l'on vient de faire une ânerie sur le
système racine habituel), ou même de démarrer un autre système
d'exploitation.
Il peut y avoir jusqu'à 16 images différentes dans lilo.conf.
.LP
Comme on peut le voir ci\-dessus, un fichier de configuration commence avec un
certain nombre d'options globales (les 6 premières lignes de l'exemple),
puis viennent les options pour chacune des images à gérer. Lorsqu'une option est
indiquée pour une image, elle a priorité sur l'option globale correspondante.

.SH "OPTIONS GLOBALES"
Il existe plusieurs mots\-clés, les descriptions ci-dessous
sont extraites de user.tex (un peu abrégées).
.TP
.BI "backup=" backup-file
Copier le secteur de boot original dans le fichier
.I backup-file
(qui peut également être un périphérique, par exemple
.IR /dev/null )
à la place de
.IR /boot/boot.NNNN .
.TP
.BI "boot=" boot-device
indique le nom du périphérique (ex : une partition de disque dur) qui
contient le secteur de boot. Si ce mot\-clé est omis, le secteur de boot
lu (et éventuellement écrit) est celui du périphérique actuellement
monte comme racine du système de fichiers.
.TP
.BI "change-rules"
définit les changements au moment du boot des numéros de partition (masquage).
Voir la section "Partition type change rules" du fichier user.tex pour plus de détails.
.TP
.BI "compact"
Essaye de regrouper les lectures de secteurs adjacents en une seule
requête. Ceci réduit nettement le temps de chargement et la taille
du fichier de carte. L'utilisation de `compact' est surtout recommandée lorsque
l'on boote depuis une disquette.
.TP
.BI "default=" name
Utiliser par défaut l'image indiquée. Si `default' est omis, la
première image du fichier de configuration est utilisée comme image
par défaut.
.TP
.BI "delay=" dsecs
indique la durée (en dixièmes de secondes) pendant laquelle le chargeur
attendra avant de démarrer la première image. Ceci est utilisé sur les
systèmes qui bootent immédiatement sur le disque dur après avoir mis
le clavier en marche. Si `delay' est absent, ou si sa valeur est nulle,
le chargeur n'attend pas.
.TP
.BI "disk=" device-name
Précise les valeurs des paramètres non\-standards du disque indiqué.
Voir la section "Géométrie du disque" dans user.tex pour plus de
détails.
Le paramètre `bios=' est particulièrement utile. Le BIOS numérote
les disques 0x80, 0x81... et il est impossible de savoir quel
disque Linux correspond à quel disque BIOS (car cela dépend de la
configuration du BIOS et de son type). Ainsi si votre configuration
est très particulière, vous pouvez indiquer les correspondances
entre disques Linux et disques BIOS.
Par exemple, 
.sp
.nf
    disk=/dev/sda
	bios=0x80
    disk=/dev/hda
	bios=0x81
.fi
.sp
indique que votre disque SCSI est le premier disque BIOS, et votre
disque IDE le second disque BIOS.
.TP
.BI "disktab=" disktab-file
Indique le nom d'un fichier de paramètres pour le disque. Si cette
option est absente, le fichier
.I /etc/disktab
est recherché. Il vaut mieux éviter d'utiliser ces fonctionnalités.
.TP
.BI "fix-table"
Ceci permet à Lilo d'ajuster les adresses 3D (secteur/tête/cylindre)
de la table des partitions. 
Chaque partition possède une adresse 3D et une adresse linéaire pour
son premier et son dernier secteur.

Si la partition n'est pas alignée sur une frontière de piste, et si
certains autres systèmes d'exploitation (MS\-DOS, ou OS/2) utilisent
le même disque, ils peuvent modifier l'adresse 3D.
Lilo ne peut installer son secteur de démarrage que sur des partitions
où les deux types d'adressage correspondent.
Si l'option `fix-table' est indiquée, Lilo réajustera les
adresses 3D incorrectes.

ATTENTION :
Ceci ne garantit pas que les autres systèmes d'exploitation ne vont
pas essayer de modifier à nouveau l'adressage plus tard. Il est
également possible que ces corrections aient des effets de bords
inattendus.

La véritable correction à apporter consiste à repartitionner le
disque avec un utilitaire qui aligne les partitions sur les frontières
de pistes.

De plus, avec certains disques (les gros disques EIDE avec une traduction
d'adresses automatique), et sous certaines circonstances, il est
inévitable d'obtenir des conflits dans la table des partitions.
.TP
.BI "force-backup=" backup-file
Comme `backup' mais écrase la sauvegarde précédente s'il y en a une.
.TP
.BI "ignore-table"
ne pas tenir compte des erreurs dans la table des partitions.
.TP
.BI "install=" boot-sector
Utiliser le fichier indiqué comme secteur de démarrage.
Si `install' est omis,
.I /boot/boot.b
sera utilisé par défaut.
.TP
.BI "linear"
Crée des adresses de secteur linéaires plutôt que des adresses 3D
(secteur/tete/cylindre). Les adresses linéaires sont traduites à
l'exécution, et ne dépendent pas de la géométrie du disque.

Notez que les disquettes de démarrage risquent de ne pas être portables
d'une machine à l'autre si `linear' est utilisé, car les services BIOS
pour déterminer la géométrie du disque ne fonctionnent pas bien avec les
disquettes. Quand on utilise `linear' avec des gros disques,
.I /sbin/lilo
risque de générer des références à des zones de disque inaccessibles
car les adresses 3D ne sont pas connues avant le boot.
.TP
.BI "lba32"
Utiliser des Adresses de Blocs Logiques 32-bits plutôt que les adresses
secteur/tête/cylindre. Si le BIOS supporte l'adressage par paquets, alors les
appels par paquets seront utilisés pour accéder au disque. Ceci petmet de booter
sur n'importe quelle partition d'un disque supérieur à 8.4\ Go, la limite de
l'adressage S/T/C. Si le BIOS ne supporte pas l'adressage par paquets, alors
les adresses 'lba32' sont convertie en S/T/C comme 'linear'. Avec 'lba32', toutes
les adresses sur disquette restent sous la forme S/T/C.
.TP
.BI "lock"
Autorise l'enregistrement de lignes de commande au démarrage comme
un choix par défaut pour les redémarrages ultérieurs. De cette
façon, Lilo "verrouille" un choix jusqu'à ce qu'il soit écrasé manuellement.
.TP
.BI "map=" map-file
Indique l'emplacement du fichier de carte des noyaux. Si `map' est omis,
.I /boot/map
est utilisé.
.TP
.BI "message=" message-file
indique l'emplacement d'un fichier contenant un message qui sera
affiché avant l'invite de démarrage. Aucun message n'est affiché
pendant l'attente de la touche SHIFT, après avoir imprimé "LILO ".
Dans ce message, le caractère FF (Ctrl-L) efface l'écran.
La taille du message est limitée à 65535 octets. Le fichier carte
doit être reconstruit si le message est modifié ou déplacé.
.TP
.BI "nowarn"
Désactive les avertissements à propos de risques futurs.
.TP
.BI "optional"
Correspond à l'option `optional' spécifique à une image, que l'on
applique alors à toutes les images (voir plus bas).
.TP
.BI "password=" password
Correspond à l'option `password' spécifique à une image, que l'on
applique alors à toutes les images (voir plus bas).
.TP
.BI "prompt"
Affiche obligatoirement l'invite de démarrage, sans réclamer de
pression sur SHIFT. Un redémarrage intempestif (coupure électrique)
de la machine est impossible si `prompt' est indiqué, et 
pas `timeout'.
.TP
.BI "restricted"
Correspond à l'option `restricted' spécifique à une image, que l'on
applique alors à toutes les images (voir plus bas).
.TP
.BI "serial=" paramètres
Autorise la prise de contrôle par une ligne série. Le port série 
mentionné est initialisé, et le chargeur accepte des instructions
à la fois depuis le clavier et depuis le port.

L'émission d'un `break' sur la prise série est équivalente à la
pression sur SHIFT afin de réclamer l'attention du chargeur.
Toutes les images devraient être protégées par mots de passe si 
l'accès au port série est moins sécurisé que l'accès au clavier
(par exemple à travers un modem).

La chaîne de paramètres à la syntaxe suivante :
.sp
.nf
    <port>[,<bps>[<parité>[<bits>]]]
.fi
.sp
<port>:  numéro du port série (0 correspond à COM1, alias /dev/ttyS0).
Les quatre ports (s'ils existent) peuvent être utilisés.
.sp
<bps>: vitesse du port série. Les vitesses suivantes sont supportées :
110, 150, 300, 600, 1200, 2400, 4800 et 9600 bps (2400 bps par défaut).
.sp
<parité>: parité utilisée sur la ligne. Le chargeur ignore la parité
en entrée, et élimine le 8ème bit. Les lettres suivantes décrivent
la parité : n  aucune,  e  paire, o  impaire.
.sp
<bits>: nombre de bits par caractères. Seuls les caractères de 7 et
8 bits sont supportés. (par défaut 8 si parité n, 7 si parité e ou o).
.sp
Si `serial' est indiqué, la valeur de `delay' est automatiquement
portée a 20.
.sp
Exemple : serial=0,2400n8 initialise COM1 avec les paramètres par défaut.
.TP
.BI "timeout=" dsecs
Indique un délai (en dixièmes de secondes) pour la saisie au clavier.
Si aucune touche n'est pressée durant ce délai la saisie est abandonnée.
Sur l'invite de connexion, l'image par défaut est lancée, sur la
saisie de mot de passe, l'action est annulée.
La valeur par défaut du timeout est infinie.
.TP
.BI "verbose=" niveau
Valide de nombreux rapports de progression. Plus le nombre est élevé,
plus Lilo sera volubile. Si \-v est de plus ajouté sur la ligne de
commande, le niveau sera augmenté. Le niveau maximal de volubilité est 5.
.LP
En outre, des paramètres de configuration du noyau
.BR append ", " ramdisk ", " read-only ", " read-write ", " root
et
.B vga
peuvent être indiqués dans la section des options globales. Ils sont
utilisés par défaut à moins d'être surchargés dans les sections de
configurations spécifiques des images.

.SH "SECTIONS SPÉCIFIQUES AUX IMAGES"
Une section spécifique à une image débute soit par une ligne
.sp
.nf
    \fBimage=\fP\fIpathname\fP
.fi
.sp
(qui indique un fichier ou un périphérique contenant l'image d'un
noyau Linux), soit par une ligne
.sp
.nf
    \fBother=\fP\fIpathname\fP
.fi
.sp
pour indiquer le démarrage d'un autre système d'exploitation.
.LP

Dans le premier cas, si la ligne \fBimage\fP demande le démarrage depuis
un périphérique, alors il faut également indiquer l'intervalle de
secteurs à utiliser. Ceci se fait ainsi :
.sp
.nf
         \fBrange=\fP\fIdebut\fP-\fIfin\fP
.fi
.sp

Dans le second cas (démarrer un autre système) il existe 3 options.
.TP
.BI "loader=" chain-loader
Ceci indique le chargeur à utiliser. Par défaut
.I /boot/chain.b
est utilisé. Le chargeur doit être précisé si l'on démarre depuis un
périphérique autre que le premier disque dur ou disquette.
.TP
.BI "table=" device
Cette option spécifie le périphérique qui contient la table de partitions.
Le chargeur ne transmettra pas les informations sur les partitions au
système à démarrer si cette variable est omise (certains systèmes 
d'exploitation utilisent d'autres moyens pour déterminer la partition
depuis laquelle ils démarrent, par exemple MS-DOS stocke habituellement
les informations géométriques dans son secteur de démarrage).
Notez que /sbin/lilo doit être relancé si une table de partitions référencée
dans une option `table' est modifiée.
.TP
.BI "unsafe"
Ne pas toucher au secteur de démarrage lors de la création de la carte.
Ceci désactive certains contrôles, y compris la vérification de la table
des partitions.
Si le secteur de boot se trouve sur une disquette avec un format propriétaire,
l'utilisation de UNSAFE évite d'avoir à insérer un disque lisible dans
le lecteur durant l'installation de la carte.
Les options `unsafe' et `table' sont mutuellement exclusives.
.LP

Dans tous les cas les options suivantes s'appliquent\ :
.TP
.BI "label=" nom 
Le chargeur utilise le nom de fichier principal (sans le chemin
d'accès) de chaque image pour les identifier. On peut indiquer
ici un nom différent qui sera utilisé lors de l'invite de
connexion.
.TP
.BI "alias=" nom 
Un deuxième nom peut être utilisé comme alias pour la même image.
.TP
.BI "lock"
(voir au-dessus)
.TP
.BI "optional"
Omettre l'image si elle n'est pas présente lors de la création de
la carte. Ceci est utile pour indiquer des noyaux de test qui
ne sont pas toujours présents.
.TP
.BI "password=" password
Protéger le chargement de l'image par un mot de passe.
.TP
.BI "restricted"
Ne demander un mot de passe que si l'on ajoute des paramètres
sur la ligne de commande (par exemple `single' pour redémarrer
en mode mono\-utilisateur).
.LP

.SH "OPTIONS DU NOYAU"
Si l'image chargée est un noyau Linux, on peut lui passer des
paramètres supplémentaire sur la ligne de commande.
.TP
.BI "append=" chaîne
Ajoute l'option indiquée sur la ligne de commande transmise au
noyau. Ceci est typiquement utilisé pour indiquer des paramètres
matériels qui ne peuvent pas être auto-détectés, ou pour lesquels
l'auto-détection peut être dangereuse. Par exemple :
.sp
.nf
     append = "hd=64,32,202"
.fi
.sp
.TP
.BI "literal=" chaîne
Comme `append', mais élimine de surcroît toutes les autres options
(par ex : l'emplacement du périphérique racine). Comme des options
vitales peuvent être supprimées malencontreusement avec `literal',
celle\-ci ne peut pas apparaître dans les options globales.
.TP
.BI "ramdisk=" size
Indique la taille d'un disque virtuel optionnel. Une valeur nulle
empêche la création du disque RAM. Si cette variable est omise,
la taille de disque virtuel indiquée dans la configuration de
l'image du noyau est utilisée.
.TP
.BI "read-only"
Ceci indique que le système de fichiers racine doit être monté en
lecture seule. Typiquement le démarrage du noyau remontera ce
système en lecture/écriture plus tard (après l'avoir vérifié).
.TP
.BI "read-write"
Ceci indique que le système de fichiers racine doit être monté en
lecture/écriture.
.TP
.BI "root=" root\-device
Précise le périphérique à monter en tant que racine du système de
fichier. Si le mot\-clé
.B current
est utilise en guise de
.I root\-device
la racine du système actuel est utilisée. Si la racine a été 
changée avec l'option \-r, le périphérique correspondant est utilisé.
Si la variable `root' est omise, le périphérique indiqué dans l'image
du noyau est utilisé.
(Il est positionné au moment de la compilation par la variable ROOT_DEV
dans le fichier Makefile, et peut être changé ultérieurement avec le
programme
.IR rdev (8)).
.TP
.BI "vga=" mode
Ceci précise le mode texte VGA à utiliser pendant le démarrage. Les
valeurs suivantes sont autorisées (pas de différence majuscule/minuscule) :
.sp
.BR normal :
Mode texte 80x25 normal.
.sp
.BR extended " (ou " ext ):
Mode texte 80x50.
.sp
.BR ask :
Arrêter et demander à l'utilisateur (lors du démarrage).
.sp
<numéro>:  Utiliser le mode texte correspondant. Une liste des
modes disponibles peut être obtenue en démarrant avec
.I vga=ask  
et en pressant [Enter]. 
.sp
Si cette variable est omise, le mode VGA déclaré dans l'image du noyau
est utilisé. (Le mode est indiqué à la compilation du noyau dans la
variable SVGA_MODE du fichier Makefile, et peut être changé ultérieurement
avec le programme
.IR rdev (8)).
.SH "VOIR AUSSI"
lilo(8), rdev(8).
.br
La distribution Lilo est accompagnée d'une documentation très complète, dont
la présente page n'est qu'un extrait.

.SH TRADUCTION
Christophe Blaess, 1997-2003.
