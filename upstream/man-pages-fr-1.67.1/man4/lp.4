'\" t
.\" Copyright (c) Michael Haardt (michael@cantor.informatik.rwth-aachen.de), Sun Jan 15 19:16:33 1995
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
.\" USA.
.\"
.\" Modified, Sun Feb 26 15:02:58 1995, faith@cs.unc.edu
.\"
.\" Traduction 18/10/1996 par Christophe Blaess (ccb@club-internet.fr)
.\" LDP 1.47
.\" Màj 25/07/2003 LDP-1.56
.\" Màj 04/07/2005 LDP-1.61
.\" Màj 01/05/2006 LDP-1.67.1
.\"
.TH LP 4 "15 JANVIER 1995" LDP "Manuel du programmeur Linux"
.SH NOM
lp \- Imprimantes parallèles.
.SH SYNOPSIS
#include <linux/lp.h>
.SH CONFIGURATION
\fBlp\fP[0\(en2] sont des périphériques caractères pour les imprimantes à
liaison parallèle. Ils ont un numéro majeur 6 et un numéro mineur 0\(en2.
Le numéro mineur correspond aux ports d'imprimantes d'adresse de base
0x03bc, 0x0378 et 0x0278.
Habituellement, ils ont un mode d'accès 220 et un propriétaire root.lp.
On peut utiliser les ports parallèles soit en scrutation (polling) soit
en interruption. L'utilisation en interruption est surtout recommandée
avec un haut trafic (p.ex.\ : imprimante laser). Pour les imprimantes
matricielles classiques, la scrutation suffira. Par défaut, le système
utilise la scrutation.
.SH DESCRIPTION
Les appels-système
.IR ioctl (2)
suivants sont supportés\ :
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPTIME, int \fP\fIarg\fP\fB)\fP"
fixe la durée pendant laquelle le pilote s'endort avant de revérifier
l'état de l'imprimante après que le tampon ait été rempli.
Avec une imprimante rapide, on peut diminuer ce délai\ ; avec une imprimante
lente on peut l'augmenter.
La durée est indiquée dans \fIarg\fP, en centièmes de secondes. La valeur
par défaut est 2 (soit 0,02 seconde). Cela n'influe que sur le pilote
en scrutation.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPCHAR, int \fP\fIarg\fP\fB)\fP"
indique le nombre maximum d'itérations d'attente active que le pilote
en scrutation effectue alors qu'il attend que l'imprimante soit prête.
Si l'impression est trop lente, augmenter cette valeur\ ; si le système
ralentit trop, la diminuer.
Le nombre est indiqué dans \fIarg\fP, la valeur par défaut est 1000. Cela
n'influe que sur le pilote en scrutation.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPABORT, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0, le pilote réessaiera en cas d'erreur d'impression,
sinon il abandonnera. La valeur par défaut est 0.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPABORTOPEN, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0,
.IR open (2)
sera annulé en cas d'erreur, sinon l'erreur sera ignorée. Par défaut, elle
est ignorée.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPCAREFUL, int \fP\fIarg\fP\fB)\fP"
Si \fIarg\fP vaut 0, on bloquera l'écriture sur le port parallèle au cas
où les broches \fIerreur\fP, \fIplus\-de\-papier\fP, ou \fIimprimante\-hors\-ligne\fP
sont validées. Sinon, ces signaux seront ignorés. Par défaut,
ils sont ignorés.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPWAIT, int \fP\fIarg\fP\fB)\fP"
Indique le nombre d'itérations d'attente active à effectuer avant d'activer
la broche STROBE pour que l'imprimante accepte le caractère écrit,
et le nombre d'itérations à effectuer avant d'éteindre à nouveau la
broche STROBE.
Les spécifications indiquent que ce délai devrait être de 0,5 micro\-secondes,
mais l'expérience a montré que le délai induit par le code du pilote
est suffisant. La valeur est indiquée dans \fIarg\fP, elle vaut 0
par défaut. Ceci concerne autant le gestionnaire en interruption que
celui en scrutation.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPSETIRQ, int \fP\fIarg\fP\fB)\fP"
Cet ioctl() nécessite des privilèges super-utilisateur. Son argument est une
nouvelle IRQ pour l'imprimante. Comme effet de bords, l'imprimante est
réinitialisée. Si \fIarg\fP vaut 0, le gestionnaire en scrutation sera
utilisé, ce qui est le comportement par défaut.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPGETIRQ, int *\fP\fIarg\fP\fB)\fP"
Stocke la valeur actuelle d'IRQ dans \fIarg\fP.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPGETSTATUS, int *\fP\fIarg\fP\fB)\fP"
Stocke le statut actuel du port dans \fIarg\fP. Les bits ont les significations
suivantes\ :
.sp
.TS
l l.
LP_PBUSY	Entrée OCCUPÉE inversée, active à 1
LP_PACK	Entrée ACQUITTEMENT, active à 0
LP_POUTPA	Entrée PLUS-DE-PAPIER, active à 1
LP_PSELECD	Entrée SELECT, active à 1
LP_PERRORP	Entrée ERREUR, active à 0
.TE
.sp
Référez-vous au manuel de votre imprimante pour la signification de ces
signaux. Des bits non documentés peuvent également être présents,
suivant le type d'imprimante.
.IP "\fBint ioctl(int \fP\fIfd\fP\fB, LPRESET)\fP"
Réinitialise l'imprimante.  Pas d'argument.
.SH FICHIERS
/dev/lp*
.SH AUTEURS
Le pilote d'imprimante a été écrit à l'origine par Jim Weigand et Linus
Torvalds. Il fut ensuite amélioré par Michael K.\& Johnson. Le code
d'interruption a été écrit par Nigel Gamble. Alan Cox l'a modularisé.
LPCAREFUL, LPABORT, LPGETSTATUS ont été ajoutés par Chris Metcalf.
.SH "VOIR AUSSI"
.BR mknod (1),
.BR chown (1),
.BR chmod (1),
.BR tunelp (8),
.BR lpcntl (8)
.SH TRADUCTION
.PP
Ce document est une traduction réalisée par Christophe Blaess
<http://www.blaess.fr/christophe/> le 18\ octobre\ 1996
et révisée le 2\ mai\ 2006.
.PP
L'équipe de traduction a fait le maximum pour réaliser une adaptation
française de qualité. La version anglaise la plus à jour de ce document est
toujours consultable via la commande\ : «\ \fBLANG=en\ man\ 4\ lp\fR\ ».
N'hésitez pas à signaler à l'auteur ou au traducteur, selon le cas, toute
erreur dans cette page de manuel.
