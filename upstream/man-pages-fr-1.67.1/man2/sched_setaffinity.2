.\" man2/sched_setaffinity.2 - sched_setaffinity and sched_getaffinity man page
.\"
.\" Copyright (C) 2002 Robert Love
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111,
.\" USA.
.\"
.\" 2002-11-19 Robert Love <rml@tech9.net> - initial version
.\" 2004-04-22 aeb - added glibc prototype history
.\"
.\" Traduction Christophe Blaess <ccb@club-internet.fr>
.\" Màj 18/07/2003 LDP-1.56
.\" Màj 23/12/2005 LDP-1.67
.\" Màj 01/05/2006 LDP-1.67.1
.\"
.TH SCHED_SETAFFINITY 2 "22 avril 2004" LDP "Manuel du programmeur Linux"
.SH NOM
sched_setaffinity, sched_getaffinity \- Définir et récupérer le masque d'affinité CPU d'un processus
.SH SYNOPSIS
.B #include <sched.h>
.sp
\fBint sched_setaffinity(pid_t \fIpid\fB, unsigned int \fIlg\fB, unsigned long *\fImasque\fB);
.sp
\fBint sched_getaffinity(pid_t \fIpid\fB, unsigned int \fIlg\fB, unsigned long *\fImasque\fB);

.SH DESCRIPTION
.B sched_setaffinity
fixe le masque des préférences du processus
.I pid
vis-à-vis du CPU.
Si
.I pid
vaut zéro, il s'agit du processus appelant.
.sp
Les préférences sont représentées par les bits stockés dans le
.IR masque .
Le bit de moindre poids représente le numéro logique du premier processeur, tandis
que le bit de poids le plus fort représente le numéro de dernier processeur.
Un bit activé correspond à un processeur utilisable pour l'ordonnancement
alors qu'un bit inhibé représente un processeur refusé. En d'autres termes,
le processus est attaché et ne s'exécutera que sur les processeurs dont
les bits sont activés. D'habitude, tous les bits du masque sont validés.
.sp
L'argument
.I lg
représente la longueur des données pointées par le
.IR masque .
Normalement, il s'agit de la taille d'un mot du système. Pour assurer la
compatibilité avec les futurs noyaux Linux, comme cette taille peut varier,
le masque fourni doit être au moins aussi grand que le masque d'affinité
stocké dans le noyau.
.sp
La fonction
.B sched_getaffinity
écrit dans la zone pointée par
.I masque
(dont la taille est
.IR lg )
le masque de préférences du processus
.IR pid .
Si
.I pid
vaut zéro, le masque du processus en cours est renvoyé.

.SH "VALEUR RENVOYÉE"
S'ils réussissent
.BR sched_setaffinity
et
.BR sched_getaffinity
renvoient tous deux zéro.
S'ils échouent, ils renvoient \-1 et
.I errno
sera rempli avec le code d'erreur.

.SH ERREURS
.TP
.B EFAULT
Une adresse mémoire est invalide.
.TP
.B ESRCH
Impossible de trouver le processus du \fIpid\fR indiqué.
.TP
.B EPERM
Le processus appelant n'a pas les privilèges appropriés. Le processus qui
invoque
.BR sched_setaffinity
doit avoir un UID effectif égal à l'UID effectif ou réel du
processus identifié par
.IR pid ,
ou avoir la capacité
.IR CAP_SYS_NICE .
.TP
.B EINVAL
Le
.I masque
des préférences ne contient pas de processeurs présents sur le système, ou
.I lg
est plus petit que la taille du masque d'affinité utilisé par le noyau.
.SH "HISTORIQUE"
Les appels système d'affinité ont été introduit dans Linux 2.5.8.
Les appels bibliothèque ont été introduit dans glibc 2.3 et sont encore
présents dans glibc 2.3.2. Les versions de développement postérieures à
glibc 2.3.2 ont modifié cette interface en une sans le champ
.IR len ,
et les versions suivantes sont revenues en arrière.
Le prototype glibc est à présent
.sp
.nf
/* Définir l'affinité CPU d'une tâche */
extern int sched_setaffinity (pid_t pid, size_t cpusetsize,
                              const cpu_set_t *cpuset);
.sp
/* Récupérer l'affinité CPU d'une tâche */
extern int sched_getaffinity (pid_t pid, size_t cpusetsize,
                              cpu_set_t *cpuset);
.fi
.SH "VOIR AUSSI"
.BR sched_setscheduler (2),
.BR sched_getscheduler (2),
.BR sched_get_priority_max (2),
.BR sched_get_priority_min (2),
.BR nice (2),
.BR setpriority (2),
.BR getpriority (2),
.PP
.BR sched_setscheduler (2)
décrit le fonctionnement de l'ordonnancement sous Linux.
.SH TRADUCTION
.PP
Ce document est une traduction réalisée par Christophe Blaess
<http://www.blaess.fr/christophe/> le 18\ juillet\ 2003
et révisée le 2\ mai\ 2006.
.PP
L'équipe de traduction a fait le maximum pour réaliser une adaptation
française de qualité. La version anglaise la plus à jour de ce document est
toujours consultable via la commande\ : «\ \fBLANG=en\ man\ 2\ sched_setaffinity\fR\ ».
N'hésitez pas à signaler à l'auteur ou au traducteur, selon le cas, toute
erreur dans cette page de manuel.
