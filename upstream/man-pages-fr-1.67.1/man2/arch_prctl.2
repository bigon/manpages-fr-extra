.\" Hey Emacs! This file is -*- nroff -*- source.
.\"
.\" Copyright (C) 2003 Andi Kleen
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Traduction Christophe Blaess <ccb@club-internet.fr>
.\" Màj 18/07/2003 LDP-1.56
.\" Màj 01/05/2006 LDP-1.67.1
.\"
.TH ARCH_PRCTL 2 "2 février 2003" LDP "Manuel du programmeur Linux"
.SH NOM
arch_prctl \- Fixe l'état spécifique à l'architecture.
.SH SYNOPSIS
.B #include <asm/prctl.h>
.sp
.B #include <sys/prctl.h>
.sp
.BI "int arch_prctl(int code, unsigned long adr)"
.SH DESCRIPTION
La fonction
.B arch_prctl
fixe l'état spécifique à l'architecture pour le thread ou le processus.
.I code
sélectionne une sous-fonction
et lui passe
l'argument
.IR addr .
.LP
Les sous-fonctions pour les architectures x86-64 sont\ :
.TP
.B ARCH_SET_FS
Remplit la base 64-bits pour le registre
.I FS
avec
.IR adr .
.TP
.B ARCH_GET_FS
Renvoie la base 64-bits pour le registre
.I FS
du thread en cours dans la variable
.I unsigned long
pointée par le
paramètre
.IR adr .
.TP
.B ARCH_SET_GS
Remplit la base 64-bits pour le registre
.I GS
avec
.IR addr .
.TP
.B ARCH_GET_GS
Renvoie la base 64-bits pour le registre
.I GS
du thread en cours dans la variable
.I unsigned long
pointée par le
paramètre
.IR adr .
.SH NOTES
.I arch_prctl
n'est seulement supporté sur Linux/x86-64 pour les programmes 64-bits.

La base 64-bits change lorsqu'un nouveau selecteur de segment 32-bits est chargé.

.B ARCH_SET_GS
est inactif dans certains noyaux.

Les changements de contextes pour les bases 64-bits sont assez coûteux. Il peut être
plus rapide de fixer une base 32-bits avec un sélecteur de segment en fixant
une LDT avec
.BR modify_ldt (2)
ou en utilisant l'appel système
.BR set_thread_area (2)
des noyaux 2.5.
.B arch_prctl
n'est utile que si vous désirez fixer des bases plus grandes que 4Go.
La mémoire dans les premiers 2\ Go d'adressage peut être allouée en utilisant
.BR mmap (2)
avec
l'attribut.
.IR MAP_32BIT .

Il n'y a pas de prototype pour
.I arch_prctl
Dans la GlibC 2.2. Vous devez le déclarer vous-même.
Ceci sera corrigé dans les futures versions de la GlibC.

.I FS
peut être déjà utilisé par la bibliothèque de multi-threading.
.SH ERREURS
.TP
.B EINVAL
.I code
n'est pas une sous-commande valide.
.TP
.B EPERM
.I adr
pointe en dehors de l'espace d'adressage du processus.
.TP
.B EFAULT
.I adr
pointe vers une adresse non affectée ou est en dehors de l'espace d'adressage.
.SH AUTEUR
Page de manuel écrite par Andi Kleen.
.SH CONFORMITÉ
.I arch_prctl
est une extension Linux/x86-64 et ne doit pas être employée dans un programme portable.
.SH "VOIR AUSSI"
.BR mmap (2),
.BR modify_ldt (2),
.BR prctl (2),
.BR set_thread_area (2)
.sp
Manuel du programmeur AMD X86-64
.SH TRADUCTION
.PP
Ce document est une traduction réalisée par Christophe Blaess
<http://www.blaess.fr/christophe/> le 18\ juillet\ 2003
et révisée le 2\ mai\ 2006.
.PP
L'équipe de traduction a fait le maximum pour réaliser une adaptation
française de qualité. La version anglaise la plus à jour de ce document est
toujours consultable via la commande\ : «\ \fBLANG=en\ man\ 2\ arch_prctl\fR\ ».
N'hésitez pas à signaler à l'auteur ou au traducteur, selon le cas, toute
erreur dans cette page de manuel.
